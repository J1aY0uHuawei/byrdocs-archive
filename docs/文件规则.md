# 文件规则

> 本文档主要介绍 BYR Docs 文件的分类及其质量要求。

## 文件 URL

BYR Docs 所存储的文件均以 md5sum 来命名。它们的 URL 格式为 `https://byrdocs.org/files/${md5sum}.${ext}`，例如：

- `https://byrdocs.org/files/dd6388976e48a6ce2f8a30355acfcba0.pdf`
- `https://byrdocs.org/files/62b43f8fbed2bb3087f2afc96fd89b0f.zip`

所以，如果你预先知道了某个文件的 md5sum 和后缀名，你就可以直接通过 URL 来下载它。

通过 [BYR Docs Publish](https://publish.byrdocs.org) 上传的文件也会用 md5sum 重命名，然后其他人可以通过 URL 直接下载它。但是注意，如果不通过审核（即把 yaml 文件添加至 [Archive](https;//github.com/byrdocs/byrdocs-archive)），这些文件是无法搜索到的。

## 文件收录规则

我们人为地将文件区分成三个类别（type）：**书籍**（book）、**试题**（test）、**资料**（doc）。

一份文件必须满足以下条件方可收录：

- **书籍** 必须满足以下条件
  - 是书籍（课件、笔记等形式不符合书籍这一定义）
  - 是PDF格式的电子书（若为EPUB等其它格式，请转换为PDF）
  - 是正式出版物（以个人/团体名义公开发表，但未经出版的书籍不属于此类）
  - 是教育资源（小说、散文、漫画等均不属于此类，除非有充分证据证明它是教育资源）
- **试题** 必须满足以下条件
  - 是PDF格式的电子资料（若为纸质资料，可自行扫描、交由本团队扫描、自行制作电子版)
  - 来自北京邮电大学（不可以是外校试题）
  - 是期中/期末考试题（不可以是月考、随堂作业等阶段性试题）
  - 必须是一套实际考过的真题，正常考或缓考均可（不可以是题库、模拟卷等。即使其中的大多数题目真的出现在真题中也不行）
- **资料** 可以认为是以上两类的补集，不符合以上两类要求的文件可以算作此类，但是仍需满足以下条件
  - 是PDF或ZIP格式（如不是，可考虑自行制作ZIP格式再提交）
  - 是教育资源（学校的培养方案、规章通知等不属于此类）
  - 必须能够对应到至少一门课程（否则就是无关资料）
  - 必须与课程学习、考试复习相关（竞赛资料，例如大学生数学竞赛、大学生英语竞赛的相关资料不应收录）

一个文件即便符合以上条件，也有可能因为不符合质量要求而遭拒。常见的情况有：

- 文件模糊不清晰，影响正常阅读。*请自行想办法解决。*
- 文件有明显的缺页、重页、页面乱序问题，影响正常阅读。*请自行收集缺页，删除重页或调整页面顺序。*
- 文件杂糅（比如，多套题目合并到了同一个PDF文件中）。*请自行拆分为多个PDF，再分别提交。*
- 缺失封面（见[文件封面](#文件封面)）

## 文件去重与比较

狭义上的去重就是按 md5sum 来去重。在通过 BYR Docs Publish 上传时，若服务器中已存在相同文件，则上传失败。

广义上的去重包含但不限于以下情况：

- 同一本书有若干不同的PDF，每个文件的质量都不同；
- 同样是一份试题，有一版有原题而无答案，有一版有答案而无原题，有一版既有原题又有答案，不过答案是嵌入原题中的；
- 同样的两份资料，学科相同，但内容又各有异同，只有部分重复……

这种去重问题十分复杂，此处仅介绍一些常见的原则：

### 书籍的重复问题

在两本书均没有质量问题（比如缺页漏页，或者很糟糕的清晰度）的前提下，我们有以下取舍指标：

- 若某本书的清晰度高于另一本，那么我们更倾向于选择前者。
- 若某本书有封面而另一本书没有，那么我们更倾向于选择前者（可以减少自行添加封面的麻烦）。
- 若某本书有完善的书签（bookmarks）而另一本书没有，那么我们更倾向于选择前者。

### 试题的重复问题

- 若其中一份仅有原题，而另一份仅有答案，建议将其合并成同一个文件，以便用户一次性下载原题和答案。
- 若其中一份仅有原题，而另一份将答案嵌入原题中，那么建议将两者合并，原题在前，答案在后。（很多用户可能希望先做一遍再看答案，不想一上来就看到答案）
- 若其中一份仅有答案，而另一份既有原题又有答案，那么前者无需保留，直接删除即可。

还有一些情况是：试题所指示的年份和科目都完全相同，但是内容基本不一致。这种重复在某些情形下是合理的：

- 正常考和补考的题目不相同；
- 不同学院的考卷不相同；
- 为避免作弊，使用了多份考卷进行考试（貌似只有疫情时期存在过这种情况）；

总之，试题的去重需要考虑的东西比较多，上传者必须谨慎处理，以免上传重复试题增加维护难度。

## 文件封面

为方便用户查找文件，BYR Docs 为每个 PDF 文件都制作了一份封面。读者找书时，只需看封面图就可以从众多候选项书籍中找到自己想要的那本。

我们会自动提取 PDF 文件的第一页，并做一些必要的处理，将其转换成符合要求的JPG和WEBP文件。

如果一份电子书没有封面页（比如直接从目录页或正文开始），则必须在第一页前添加封面，否则会因不符合质量要求而遭拒。
